@model BankViewModel
@{
    ViewData["Title"] = Resource.BankManagement;
    Layout = "~/Views/Shared/_AdminLayout.cshtml";
}
@if (Model.Bank.Id==Guid.Empty)
{
<h4>@Resource.AddNew</h4>
}
else
{
    <h4>@Resource.Edit | @Model.Bank.Name</h4>

}
<form asp-action="SaveBank" method="post" class="was-validated" enctype="multipart/form-data">
    <input type="hidden" asp-for="Bank.Id" />
    <div class="form-group">
        <label asp-for="Bank.Name"></label>
        <input type="text" asp-for="Bank.Name" class="form-control" required="" />
    </div>
    <img alt="@Resource.Image" src="@Url.Content("~/"+Domain.File.GetImage(HttpContextAccessor.HttpContext,Model.Bank.Image))" class="img-thumbnail w-25 d-block">

    <div class="form-group mt-3">
        <label asp-for="Bank.Image"></label>
        <input asp-for="Bank.Image" name="formFiles[]" type="file" class="file" data-show-upload="false" data-show-caption="true" data-show-preview="true">
    </div>
    <div class="form-group">
        <button type="submit" class="btn btn-primary">@Resource.Save</button>
    </div>
</form>

@if (Model.Bank.Id != Guid.Empty)
{
    <hr />

    <h4>@Resource.Translations</h4>
    <button type="button" onclick="addBankTranslation()" class="btn btn-success btn-sm"><i class="icon-plus"></i> @Resource.AddTranslation</button>

    <div class="table-responsive mt-2">
        <table class="table table-striped table-bordered datatable" width="100%">
            <thead>
                <tr>
                    <th>@Resource.BankName</th>
                    <th>@Resource.Language</th>
                    <th></th>
                </tr>
            </thead>
            <tfoot>
                <tr>
                    <th>@Resource.BankName</th>
                    <th>@Resource.Language</th>
                    <th></th>
                </tr>
            </tfoot>
            <tbody>
                @foreach (var regionTranslation in Model.Bank.BankTranslations)
                {
                    <tr>
                        <td>@regionTranslation.Name</td>
                        <td>@regionTranslation.Language.Name</td>
                        <td class="w-25">
                            <button onclick="updateBankTranslation('@regionTranslation.Id','@regionTranslation.Name','@regionTranslation.LanguageId')" type="button" class="btn btn-success btn-sm"><i class="icon-edit"></i> @Resource.Edit</button>
                            <a href="@Url.Action("RemoveBankTranslation",new {id=regionTranslation.Id})" class="btn btn-danger btn-sm"><i class="icon-trash"></i> @Resource.Delete</a>
                        </td>
                    </tr>
                }
            </tbody>
        </table>
    </div>


    <div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-body">
                <form asp-action="SaveBankTranslation" method="post" class="was-validated modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="myModalLabel">@Resource.AddNew</h5>
                        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                    </div>
                    <div class="modal-body">
                        <input type="hidden" asp-for="BankTranslation.Id" />
                        <input type="hidden" asp-for="BankTranslation.BankId" value="@Model.Bank.Id" />
                        <div class="form-group">
                            <label asp-for="BankTranslation.LanguageId">@Resource.Language</label>
                            <select asp-items="ViewBag.Languages" asp-for="BankTranslation.LanguageId" class="form-control" required="">
                                <option value="">@Resource.PleaseSelect</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label asp-for="BankTranslation.Name">@Resource.BankName</label>
                            <input type="text" asp-for="BankTranslation.Name" class="form-control" required="" />
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-dismiss="modal">@Resource.Cancel</button>
                        <button type="submit" class="btn btn-primary">@Resource.Save</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

}
@section scripts
{
    <script>
        updateMenu("regions");

        function updateBankTranslation(id, name,langId) {
            $("#myModalLabel").html('@Resource.Edit :' + name);
            $("#BankTranslation_Id").val(id);
            $("#BankTranslation_Name").val(name);
            $("#BankTranslation_LanguageId").val(langId);
            $("#myModal").modal("show");
        }

        function addBankTranslation() {
            $("#myModalLabel").html('@Resource.Edit');
            $("#BankTranslation_Id").val("");
            $("#BankTranslation_Name").val("");
            $("#BankTranslation_LanguageId").val("");
            $("#myModal").modal("show");
        }
    </script>
}
