@model IEnumerable<Data.Models.Chalets.ChaletUser>

@{
    ViewData["Title"] = "Chalets";
    Layout = "~/Views/Shared/_UserAccountLayout.cshtml";
    //
    var link = Url.Action("Chalet");
}

<div class="container">
    <h3>@Resource.MyProperties</h3>
    <div class="btn-group">
        <button class="btn btn-primary btn-sm dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">@Resource.CreateNewProperty</button>
        <div class="dropdown-menu">
            <a class="dropdown-item" href="~/UserAccount/Chalet?type=@((int)Enums.PropertyType.Resort)">@Resource.Resort</a>
            <a class="dropdown-item" href="~/UserAccount/Chalet?type=@((int)Enums.PropertyType.Reset)">@Resource.Break</a>
            <a class="dropdown-item" href="~/UserAccount/Chalet?type=@((int)Enums.PropertyType.Villa)">@Resource.Villa</a>
        </div>
    </div>
    <div class="table-responsive">
        <table class="table table-striped table-bordered w-100 mt-2">
            <thead>
                <tr>
                    <th>@Resource.PropertyName</th>
                    <th>@Resource.PropertyType</th>
                    <th>@Resource.ViewStatus</th>
                    <th></th>
                </tr>
            </thead>
            <tbody>
                @foreach (var chalet in Model.Where(c => !c.IsDeleted))
                {
                    var image = "";
                    if (chalet.Chalet.PropertyType == (int)Enums.PropertyType.Resort)
                    {
                        if (chalet.Chalet.ChaletImages.Count > 0)
                        {
                            var chaletImage = chalet.Chalet.ChaletImages.OrderByDescending(c => c.IsPrimary).FirstOrDefault();
                            image = Url.Content("~/" + chaletImage.File.FileContentMin);
                        }
                    }
                    else
                    {
                        if (chalet.Chalet.Units.FirstOrDefault().UnitImages.Count > 0)
                        {
                            var chaletImage = chalet.Chalet.Units.FirstOrDefault().UnitImages.OrderByDescending(c => c.IsPrimary).FirstOrDefault();
                                image = Url.Content("~/" + chaletImage.File.FileContentMin);
                        }
                    }

                    <tr>
                        <td>
                            <a href="@Url.Action("Setting",new {id=chalet.Chalet.Id })">
                                <img style="width:100px" src="@image" onerror="this.onerror = null; this.src = '@Url.Content("~/Images/noimg.jpg")';" alt="Image">
                                @chalet.Chalet.ChaletName
                            </a>

                        </td>
                        <td>
                            @switch (chalet.Chalet.PropertyType)
                            {
                                case (int)Enums.PropertyType.Villa:
                                    <span>@Resource.Villa</span>
                                    break;
                                case (int)Enums.PropertyType.Reset:
                                    <span>@Resource.Break</span>
                                    break;
                                case (int)Enums.PropertyType.Resort:
                                    <span>@Resource.Resort</span>
                                    break;
                            }
                        </td>
                        <td>
                            @if (chalet.Chalet.ViewStatus)
                            {
                                <span class="text-success">@Resource.ViewStatusShown</span>
                            }
                            else
                            {
                                <span class="text-danger">@Resource.ViewStatusHidden</span>
                            }
                        </td>
                        <td class="w-25">
                            <a href="@Url.Action("Setting",new {id=chalet.Chalet.Id })" class="btn btn-primary btn-sm w-100 mb-2"><i class="icon-building"></i> @Resource.ManageProperty</a>
                            <a href="@link/@chalet.ChaletId" class="btn btn-success btn-sm w-100"><i class="icon-edit"></i> @Resource.Edit</a>
                        </td>
                    </tr>
                }
                @if (Model.Count() == 0)
                {
                    <tr>
                        <th colspan="4" class="text-center">@Resource.NoRecord</th>
                    </tr>
                }
            </tbody>
        </table>
    </div>
    @*@foreach (var chalet in Model)
        {
            var image = "";
            if (chalet.Chalet.ChaletImages.Count > 0)
            {
                var chaletImage = chalet.Chalet.ChaletImages.OrderByDescending(c => c.IsPrimary).FirstOrDefault();
                image = Url.Content("~/" + chaletImage.File.FileContentMin);
            }
            <div class="entry col-12 border">
                <div class="grid-inner no-gutters">
                    <div class="row pt-3 pb-3">
                        <div class="col-auto">
                            <div class="entry-image mb-0">
                                <a href="@link/id=@chalet.Id"><img style="width:100px" src="@image" onerror="this.onerror = null; this.src = '@Url.Content("~/Images/noimg.jpg")';" alt="Image"></a>
                            </div>
                        </div>
                        <div class="col-md-5 col-lg-5 col-sm-12">
                            <div class="entry-title">
                                <h4>
                                    <a href="@link/id=@chalet.Id">@chalet.Chalet.ChaletName</a> |
                                    @if (chalet.Chalet.ViewStatus)
                                    {
                                        <span class="text-success">@Resource.ViewStatusShown</span>
                                    }
                                    else
                                    {
                                        <span class="text-danger">@Resource.ViewStatusHidden</span>

                                    }
                                </h4>
                                <h4><span class="text-muted">@chalet.Chalet.City.CityName</span></h4>
                            </div>
                            <div class="mt-3">
                                <a asp-action="Index" asp-controller="Chalets" asp-route-id="@chalet.ChaletId" class="btn btn-success btn-sm">@Resource.Properties (@chalet.Chalet.Units.Count)</a>
                                <a href="~/UserAccount/Setting/@chalet.ChaletId" class="btn btn-secondary btn-sm"><i class="icon-settings2"></i> @Resource.Settings</a>
                            </div>
                        </div>
                        <div class="col-md-2 col-sm-12 text-right">
                            <a href="@link/@chalet.ChaletId" class="btn btn-success btn-sm"><i class="icon-edit"></i></a>
                            <button class="btn btn-danger btn-sm"><i class="icon-trash"></i></button>
                        </div>
                        <div class="col-md-3 border-left">
                            <div class="row">
                                <div class="col-md-6 border-right text-center">
                                    <span class="badge badge-info">1</span><br />
                                    @Resource.Reservations
                                </div>
                                <div class="col-md-6 text-center">
                                    <span class="badge badge-info">1</span><br />
                                    @Resource.Bookmark
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        }*@

</div>
